import asyncio
import os
import random
import re
from telethon import events

# –§–∞–π–ª —Å–æ —Å–ø–∏—Å–∫–æ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
CHAT_FILE = "Ignore/Auto_users.txt"  # –§–∞–π–ª —Å ID —á–∞—Ç–æ–≤
GIF_PATH = os.path.abspath("–í–∏–¥–µ–æ_–º–∞—Ç–µ—Ä–∏–∞–ª/Gif/Virus.gif")  # –ü—É—Ç—å –∫ –≥–∏—Ñ–∫–µ

WELCOME_MESSAGES = [  
    "**–ù—É –≤—Å—ë, —Ç—ã –ø–æ–ø–∞–ª—Å—è! üòà**\n\n–¢—ã —Ç–∞–∫ –¥–æ–ª–≥–æ –∏–≥–Ω–æ—Ä–∏–ª –Ω–∞—Å, —á—Ç–æ —Ç–µ–ø–µ—Ä—å –ø–æ–¥—Ö–≤–∞—Ç–∏–ª –í–ò–†–£–°! ü¶† –ù–æ –Ω–µ –ø–µ—Ä–µ–∂–∏–≤–∞–π, –µ—Å—Ç—å —Å–ø–æ—Å–æ–± –µ–≥–æ —É–¥–∞–ª–∏—Ç—å... üòè\n\n‚úÖ –ü—Ä–æ—Å—Ç–æ –ø–æ–¥–ø–∏—à–∏—Å—å –Ω–∞ –Ω–∞—à–∏ –ø—Ä–æ–µ–∫—Ç—ã –∏ –∑–∞—Ö–æ–¥–∏ –Ω–∞ —Å–∞–π—Ç: https://muhamedlabs.pro",  

    "**–û –Ω–µ—Ç, –≤–∏—Ä—É—Å –∞—Ç–∞–∫–æ–≤–∞–ª! üíÄ**\n\n–¢—ã –∑–∞–±—ã–ª –ø—Ä–æ –Ω–∞—Å? –ù—É –≤–æ—Ç, —Ç–µ–ø–µ—Ä—å —Ç–≤–æ—è —Å–∏—Å—Ç–µ–º–∞ –∑–∞—Ä–∞–∂–µ–Ω–∞! üò± –ï–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π —Å–ø–æ—Å–æ–± –∏–∑–±–∞–≤–∏—Ç—å—Å—è –æ—Ç –≤–∏—Ä—É—Å–∞ ‚Äî –ø–æ–¥–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ –º–æ–∏ –ø—Ä–æ–µ–∫—Ç—ã! üöÄ\n\nüéØ –°–ø–∞—Å–∞–π—Å—è —Ç—É—Ç: https://muhamedlabs.pro",  

    "**–û—à–∏–±–∫–∞ 404? –ù–µ—Ç, –≤–∏—Ä—É—Å 100%! üî•**\n\n–¢—ã –Ω–∞—Å —Ç–∞–∫ –¥–æ–ª–≥–æ –∏–≥–Ω–æ—Ä–∏–ª, —á—Ç–æ —Å–∏—Å—Ç–µ–º–∞ —Ä–µ—à–∏–ª–∞ –æ—Ç–æ–º—Å—Ç–∏—Ç—å! üòà –¢–µ–ø–µ—Ä—å —É —Ç–µ–±—è –≤–∏—Ä—É—Å, –∏ —É–¥–∞–ª–∏—Ç—å –µ–≥–æ –º–æ–∂–Ω–æ —Ç–æ–ª—å–∫–æ –æ–¥–Ω–∏–º —Å–ø–æ—Å–æ–±–æ–º... –ü–û–î–ü–ò–°–ö–û–ô! üòè\n\n‚úÖ –°–ø–∞—Å–∞–π—Å—è —Ç—É—Ç: https://muhamedlabs.pro",  

    "**–¢—Ä–µ–≤–æ–≥–∞! üö® –¢—ã –∑–∞—Ä–∞–∂—ë–Ω!**\n\n–ú—ã –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–∞–ª–∏‚Ä¶ –Ω–æ —Ç—ã –Ω–µ —Å–ª—É—à–∞–ª! –¢–µ–ø–µ—Ä—å —É —Ç–µ–±—è –≤–∏—Ä—É—Å! ü¶† –ß—Ç–æ–±—ã –µ–≥–æ —É–¥–∞–ª–∏—Ç—å, —Å—Ä–æ—á–Ω–æ –ø–æ–¥–ø–∏—Å—ã–≤–∞–π—Å—è –Ω–∞ –Ω–∞—à–∏ –ø—Ä–æ–µ–∫—Ç—ã –∏ –∑–∞—Ö–æ–¥–∏ –Ω–∞ —Å–∞–π—Ç! üî•\n\nüåç –í–æ—Ç —Å–ø–∞—Å–µ–Ω–∏–µ: https://muhamedlabs.pro",  

    "**–í–∏—Ä—É—Å –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω! üíÄ**\n\n–¢–≤–æ—è —Å–∏—Å—Ç–µ–º–∞ –≤ –æ–ø–∞—Å–Ω–æ—Å—Ç–∏! ü¶† –ï–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π –∞–Ω—Ç–∏–≤–∏—Ä—É—Å ‚Äî –ø–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ –º–æ–∏ –ø—Ä–æ–µ–∫—Ç—ã! –ü–æ–¥–ø–∏—Å—ã–≤–∞–π—Å—è —Å–∫–æ—Ä–µ–µ, –ø–æ–∫–∞ –Ω–µ —Å—Ç–∞–ª–æ —Ö—É–∂–µ! üòè\n\n‚ö° –ñ–º–∏ —Å—é–¥–∞: https://muhamedlabs.pro",  
]  

# –§—É–Ω–∫—Ü–∏—è –∑–∞–≥—Ä—É–∑–∫–∏ —Å–ø–∏—Å–∫–∞ —á–∞—Ç–æ–≤ –∏–∑ —Ñ–∞–π–ª–∞
def load_chat_ids():
    if not os.path.exists(CHAT_FILE):
        print(f"–û—à–∏–±–∫–∞: –§–∞–π–ª '{CHAT_FILE}' –Ω–µ –Ω–∞–π–¥–µ–Ω!")
        return []
    
    with open(CHAT_FILE, "r", encoding="utf-8") as file:
        content = file.read()

    chat_ids = re.findall(r"ID —á–∞—Ç–∞: (\d+)", content)  # –†–µ–≥—É–ª—è—Ä–∫–∞ –¥–ª—è –ø–æ–∏—Å–∫–∞ ID
    return list(map(int, chat_ids))  # –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º –≤ —Å–ø–∏—Å–æ–∫ —á–∏—Å–µ–ª

async def send_welcome_message(client):
    """–û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ —Ç–æ–ª—å–∫–æ 1 —Å–ª—É—á–∞–π–Ω–æ–º—É —É—á–∞—Å—Ç–Ω–∏–∫—É."""
    chat_ids = load_chat_ids()
    
    if not chat_ids:
        print("–û—à–∏–±–∫–∞: –°–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –ø—É—Å—Ç!")
        return

    selected_chat = random.choice(chat_ids)  # –í—ã–±–∏—Ä–∞–µ–º –û–î–ò–ù —Å–ª—É—á–∞–π–Ω—ã–π —á–∞—Ç

    if not os.path.exists(GIF_PATH):
        print(f"–û—à–∏–±–∫–∞: –§–∞–π–ª –≥–∏—Ñ–∫–∏ '{GIF_PATH}' –Ω–µ –Ω–∞–π–¥–µ–Ω!")
        return

    welcome_text = random.choice(WELCOME_MESSAGES)  # –í—ã–±–∏—Ä–∞–µ–º —Å–ª—É—á–∞–π–Ω–æ–µ –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ
    await client.send_file(selected_chat, GIF_PATH, caption=welcome_text)
    print(f"Sent to {selected_chat} chat with a hyphy")

def register_auto_reply(client):
    """–†–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ—Ç —Ç—Ä–∏–≥–≥–µ—Ä –Ω–∞ —Å–ª–æ–≤–æ '—Ä–æ–Ω–∏–Ω'."""
    
    @client.on(events.NewMessage(outgoing=True))
    async def check_raffle_trigger(event):
        """–ó–∞–ø—É—Å–∫–∞–µ—Ç –ø—Ä–æ—Ü–µ—Å—Å –≤—ã–±–æ—Ä–∞ –Ω–æ–≤–æ–≥–æ –ø–æ–¥–ø–∏—Å—á–∏–∫–∞ –ø—Ä–∏ —Å–ª–æ–≤–µ '—Ä–æ–Ω–∏–Ω'."""
        if "—Ä–æ–Ω–∏–Ω" in event.message.text.lower():
            print("New-to-old subscriber's choice!")
            await send_welcome_message(client)
